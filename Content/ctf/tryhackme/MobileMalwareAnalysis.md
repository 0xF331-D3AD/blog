
# Mobile Malware Analysis

## *An Unknown Land*

- What known as the first malware created to affect mobile devices?

Just by googling the question I found [this article](https://www.retaildive.com/ex/mobilecommercedaily/a-brief-history-of-mobile-malware) 

> Cabir

For the rest of these questions, a simple [Wikipedia](https://en.wikipedia.org/wiki/Cabir_(computer_worm))
article will do

- What technology does this worm used to multiply?

> bluetooth

- What operating system did it infect?

> symbian

- What message did it show on the screen of the infected mobile phone?

> Caribe

---

## *Small size, a lot of destruction.*

- What is the format of the file?

> .apk

- Decode the name of the sample.

> Malware

- Which is the target platform?

> Android

---

## *Digging Deeper*

- What does Avast-Mobile can tell us about this software?

> Android:Metasploit-G [PUP]

- What program was used to create the malware?

> metasploit

- What is the package name?

[VirusTotal](https://www.virustotal.com/gui/file/e201a1d2cecf1d04d97d59abec0863c716dcf9fcad89b85d036f9163a48057e7/) -> Details -> Android Info -> Summary

> com.metasploit.stage 

- What is the SHA-1 signature?

> 74D442594ACF11DC6E3492FFEA5EB8956AFD000D

- What is the unique XML file?

> AndroidManifest.xml

- How many permissions are there inside?

> 22

- Which permission allows the application to take pictures with the camera?

> android.permission.CAMERA

- What is the message left by the community?

> THM{V1ru5-T0t4al-TWFsd2FyZS1BbmFseXNpcw}

---

## *MobSFing the sample.*

- What is the programming language used to create the program?

> java

- How many signatures does the package has?

> 1

- Application is signed with v1 signature scheme, what is it vulnerable to on Android <7.0?

> Janus

- What is the App name?

> MainActivity

- It looks like  there is a function calling for the package manager, so it can see all the installed applications. What function is that?

> b.getPackageManager()

- What is the severity of this configuration?

> medium

---

## *It doesn't smell good!*

Fisrt, I decided to install the MobSF on my own machine - it's way too inconvenient to
work remotely:

```bash
$ export CYBER_SEC_DIRECTORY='.' # Any directory goes here
$ wget "https://github.com/MobSF/Mobile-Security-Framework-MobSF/archive/refs/heads/master.zip" -O "$CYBER_SEC_DIRECTORY/MobSF.zip"
$ unzip "$CYBER_SEC_DIRECTORY/MobSF.zip" -d "$CYBER_SEC_DIRECTORY"
$ rm -f "$CYBER_SEC_DIRECTORY/MobSF.zip"
```

Then, I transfered the sample to my computer. You can download it at Malware Bazaar,
just compute sha-256 hash and search for it.

- What is the SHA-256 hash of the file?

> BD8CDA80AAEE3E4A17E9967A1C062AC5C8E4AEFD7EAA3362F54044C2C94DB52A

- After finding the sample on VirusTotal, what does the "Avast" anti-virus engine recognizes it as?

> Android:Obfus-BM [Trj]

- With what we have, try to find out the name of the sample.

> pegasus

- This became news for spying journalists, what year was that? 

> 2017

Search this malware on [Mitre](https://attack.mitre.org/software/S0316/)

- What is the ID of the MITRE ATT&CK that is associated with our sample?

> S0316

- What technique has the ability to exploit OS vulnerabilities to escalate privileges?

> T1404

- There is a permission that when accepted, allows the application to access the list of accounts in the Accounts Service. What is the status shown by MobSF regarding this permission. (android.permission.GET.ACCOUNTS)

> dangerous

- What org.eclipse.paho.client file refers to properties of Portuguese from Brazil (pt-br)?

> org/eclipse/paho/client/mqttv3/internal/nls/messages_pt_BR.properties 

- The malware has a special appeal for its safety and its internal components, reducing the risk of compromise. It has a functionality for its cryptographic operations with the feature of a random bit generation service. How can it be identified?

> FCS_RBG_EXT.1.1

