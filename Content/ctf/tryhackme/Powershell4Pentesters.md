
# ***Powershell For Pentesters***

## *Intro*

- What useful PowerShell script did you find on Walter's desktop?

> powerview.ps1

---

## *Manipulating files*

- What is the MD5 hash value of the file on Walter's  desktop?

```PS
> Get-FileHash -Algorithm MD5 .\powerview.ps1
```

> 501570FFBA7FACE69D61DA1A0843E89A

---

## *System Reconnaissance*

-  What Windows Security Update was installed on 5/15/2019?

```PS
> Get-HotFix | Export-Csv hotfix.csv

> Get-Content .\hotfix.csv | findstr "5/15/2019"
```

> KB4499728

---

## *Using PowerView*

```PS
> Import-Module .\powerview.ps1
```

- One of the accounts has a special description; what is it?

```PS
> Get-NetUser 
```

> IDF-17828290

- How many accounts are disabled?

```PS
> Get-NetUser | where useraccountcontrol -Match ".*ACCOUNTDISABLE.*" | Measure-Object
```

> 4

- How many users are in the "domain admins" group?

```PS
> Get-NetGroupMember "Domain Admins" | Measure-Object
```

> 3

- Which users are in the "domain admins" group? (Listed alphabetically, small, comma-separated, using space)

```PS
> (Get-NetGroupMember "Domain Admins").MemberName | Sort-Object
```

> ServerAdmin, ssilk, usand

- List shares; what is the name of the "interesting" share?

```PS
> Find-DomainShare -CheckShareAccess
```

> operationfiles

- What is the name of the user-created Group Policy?

```PS
> (Get-NetGPO).displayname
```

> Disable WinDef

- What are the first names of users' whose accounts were disabled? (Sorted alphabetically, small, comma-separated, using space)

```PS
> Get-NetUser | where useraccountcontrol -Match ".*ACCOUNTDISABLE.*" | Sort-Object dispayname | Format-Table displayname
```

> Daniel, Ursula
