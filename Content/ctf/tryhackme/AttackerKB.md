# AttackerKB

In this room we'll be exploring an amazing resource called [AttackerKB](https://attackerkb.com/).
It is similar to [ExploitDB](https://www.exploit-db.com/), however provides you with a lot more
information about vulnerabilities, exploits and mitigations (And the interface is way nicer :3).

---

## *Discovering the Lay of the Land*

We'll start with nmap scan:

> `sudo nmap 10.10.202.43 -Pn -p- -A -vv -T4 --script discovery,vuln -oN nmap-scan`

Select running services with this command:

> `cat nmap-scan | grep -e '[0-9]\+/tcp[[:space:]].*' -o`

The services we got:

- 22/tcp    open  ssh     syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
- 10000/tcp open  http    syn-ack ttl 63 MiniServ 1.890 (Webmin httpd)

Using this data, we can answer all questions from this section:

- Scan the machine with Nmap. What non-standard service can be found running on the 
high-port?

> Webmin

- Further enumerate this service, what version of it is running?

> 1.890

Visit the webpage generated by this service. You should encounter an error due to SSL 
being present. Change the URL to use HTTPS and ignore the exception. After this, view the 
certificate. What hostname can we find on the cert details? On Firefox, you can view this 
by clicking on the 'i' in the URL, then the '>' in Connection, 'More Information', and 
then 'View Certificate' on the Security tab.

![Sertificate](https://i.postimg.cc/3xNr8K3f/webmin-cert.png)

> source

---

## *Learning to Fly*

- Take a look through the Assessments for this vulnerability. As an attacker, we can use 
the information posted here by other members to determine how value an exploit might be 
and any tweaks we might have to make to exploit code. Similarly, as a defender we can 
leverage these comments to gain additional situational information for vulnerabilities, 
allowing us to gauge how quickly we need to patch them. Which version of Webmin is 
immediately vulnerable to this exploit?

![Assessment 1.890](https://i.postimg.cc/SsvGJ65Y/assessment-1-890.png)

> 1.890

- What type of attack was this? Note, we're looking for how this was added to the code for Webmin, not
how this results in remote code execution (RCE).

From the screenshot above we know, that this was a...

> supply chain

attack.

- Can you find a link to a post on the webmin's website explaining what happened? What 
day was Webmin informed of an 0day exploit?

We can fing the answer using a simple dork:

> webmin 1.890 inurl:webmin

![Webmin post](https://i.postimg.cc/4yKnxVkd/webmin.png)

> August 17th 2019

- Last but certainly not least, let's find the link to our exploit. We can see in the 
Assessments that a Metasploit module was added for this backdoor. What pull number was 
this added in?

From the same post on AKB we can jump straight to the Metasploit GitHub page with
PR that adds exploit for this particular vulnerability:

> 12219

---

## *Blasting Away*

- Now that we've selected our exploit, set the options provided appropriately. Beyond 
RHOSTS and LHOST, what is the third option we must set to 'True'?

> ssl

- Run the exploit. What is the user flag?

> located at /home/dark/user.txt

- How about the root flag?

Exploit gives you a root access instantly, so no challenge here

> located at /root/root.txt
